{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/carrot-foundation/schemas/refs/heads/main/schemas/ipfs/mass-id-audit/v0.1.0/mass-id-audit.data.schema.json",
  "title": "MassID Audit Data",
  "type": "object",
  "required": [
    "methodology",
    "mass_id",
    "gas_id",
    "audit_summary",
    "rules_execution_results"
  ],
  "properties": {
    "methodology": {
      "$ref": "../../shared/references/methodology-reference/v0.1.0/methodology-reference.schema.json"
    },
    "mass_id": {
      "$ref": "../../shared/references/mass-id-reference/v0.1.0/mass-id-reference.schema.json"
    },
    "gas_id": {
      "$ref": "../../shared/references/gas-id-reference/v0.1.0/gas-id-reference.schema.json"
    },
    "audit_summary": {
      "type": "object",
      "title": "Audit Summary",
      "required": [
        "audit_date",
        "methodology_compliance",
        "total_rules_executed",
        "passed_rules",
        "failed_rules"
      ],
      "properties": {
        "audit_date": {
          "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/iso_date",
          "title": "Audit Date",
          "description": "Date when the audit was completed"
        },
        "methodology_compliance": {
          "type": "string",
          "enum": ["PASSED", "FAILED"],
          "title": "Methodology Compliance",
          "description": "Overall outcome of the audit process"
        },
        "total_rules_executed": {
          "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_negative_integer",
          "title": "Total Rules Executed",
          "description": "Total number of audit rules executed"
        },
        "passed_rules": {
          "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_negative_integer",
          "title": "Passed Rules Count",
          "description": "Number of rules that passed verification"
        },
        "failed_rules": {
          "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_negative_integer",
          "title": "Failed Rules Count",
          "description": "Number of rules that failed verification"
        }
      },
      "additionalProperties": false
    },
    "rules_execution_results": {
      "type": "array",
      "title": "Rules Execution Results",
      "description": "Detailed results of each audit rule execution.",
      "items": {
        "type": "object",
        "required": [
          "rule_name",
          "rule_id",
          "rule_slug",
          "execution_order",
          "result",
          "description",
          "rule_processor_checksum",
          "rule_source_code_version"
        ],
        "properties": {
          "rule_name": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_empty_string",
            "title": "Rule Name",
            "description": "Human-readable name of the audit rule."
          },
          "rule_id": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/uuid",
            "title": "Rule ID",
            "description": "Unique identifier for the rule."
          },
          "rule_slug": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/slug",
            "title": "Rule Slug"
          },
          "execution_order": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/positive_integer",
            "title": "Rule Execution Order",
            "description": "Sequential order in which this rule was executed."
          },
          "result": {
            "type": "string",
            "enum": ["PASSED", "FAILED"],
            "title": "Rule Execution Result",
            "description": "Result of this specific rule execution."
          },
          "description": {
            "type": "string",
            "minLength": 1,
            "maxLength": 2000,
            "title": "Rule Description",
            "description": "Detailed description of what this rule validates."
          },
          "rule_processor_checksum": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_empty_string",
            "maxLength": 200,
            "title": "Rule Processor Checksum",
            "description": "Checksum for rule processor integrity verification."
          },
          "rule_source_code_version": {
            "$ref": "../../shared/definitions/v0.1.0/definitions.schema.json#/$defs/non_empty_string",
            "maxLength": 200,
            "title": "Rule Source Code Version",
            "description": "Version identifier for the rule source code."
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
